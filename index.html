<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CBS Coin ‚Äì Community Builds Sovereignty</title>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <!-- (optioneel) Buffer polyfill, kan blijven staan -->
  <script type="module">
    import { Buffer } from "https://esm.sh/buffer@6.0.3";
    window.Buffer = Buffer;
  </script>

  <style>
    body{margin:0;font-family:'Orbitron',sans-serif;background:linear-gradient(135deg,#0f0f0f,#1a1a1a);color:#00ffcc;display:flex;flex-direction:column;align-items:center;padding:2rem}
    nav{width:100%;background:#111;padding:1rem;text-align:center;margin-bottom:2rem}
    nav a{margin:0 1rem;color:#00ffff;text-decoration:none;font-weight:bold}
    nav a:hover{text-decoration:underline}
    header{text-align:center;width:100%}
    h1{font-size:3rem;margin-bottom:.2rem}
    h2{font-size:1.5rem;font-weight:400;color:#999;margin-bottom:1rem}
    .logo{margin:1rem 0;max-width:200px}
    .section{max-width:800px;background:#111;padding:1.5rem;margin:1rem 0;border:1px solid #00ffcc;border-radius:12px}
    a{color:#00ffff;text-decoration:none}
    a:hover{text-decoration:underline}
    footer{margin-top:2rem;font-size:.9rem;color:#aaa;text-align:center}
    .button-wrapper{display:flex;flex-direction:column;gap:1rem;margin-top:1rem}
    .buy-button{padding:12px 24px;background:#00ffcc;color:#000;font-weight:bold;border-radius:8px;text-align:center;text-decoration:none;cursor:pointer}
    .social-links{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap;margin:1rem 0}
    .social-links a{display:inline-flex;align-items:center;padding:.5rem 1rem;background:#1a1a1a;border:1px solid #00ffff;border-radius:6px;font-weight:bold;color:#00ffff;text-decoration:none}
    .social-links a:hover{background:#00ffff;color:#000}
    #airdropBtn{padding:1rem 2rem;font-size:1.2rem;font-weight:bold;background-color:#00ffcc;color:#000;border:none;border-radius:12px;cursor:pointer;box-shadow:0 0 10px #00ffcc,0 0 40px #00ffcc,0 0 80px #00ffcc;transition:transform .2s ease,box-shadow .2s ease}
    #airdropBtn:hover{transform:scale(1.05);box-shadow:0 0 20px #00ffff,0 0 60px #00ffff,0 0 100px #00ffff}
  </style>
</head>
<body>
  <nav>
    <a href="index.html">Home</a>
    <a href="roadmap.html">Roadmap</a>
    <a href="tokenomics.html">Tokenomics</a>
    <a href="litepaper.html">Litepaper</a>
    <a href="dao-mainnet/dao.html">DAO</a>
    <a href="mailto:smitskecbs@gmail.com">Contact</a>
  </nav>

  <header>
    <img src="https://cyan-persistent-stork-902.mypinata.cloud/ipfs/bafybeia7qejzloll6teyt4o4orvd7bnvkg4thrfajv4rgb3fmm2odeweoa/logo.png" alt="CBS Coin Logo" class="logo" />
    <h1>CBS Coin</h1>
    <h2>Community Builds Sovereignty</h2>
    <div class="social-links">
      <a href="https://t.me/CBS_Coin" target="_blank">Telegram</a>
      <a href="https://twitter.com/CBS_Coin" target="_blank">X (Twitter)</a>
    </div>
  </header>

  <!-- AIRDROP sectie (vervangt Koop CBS) -->
  <section style="margin-top: 2rem; text-align: center;">
    <h2>üéÅ Claim 250 CBS (√©√©n keer per wallet)</h2>
    <p>Verbind Phantom, onderteken een bericht en ontvang 250 CBS gratis.</p>
    <button id="airdropBtn">üéÅ Claim 250 CBS</button>
    <p id="status"></p>
  </section>

  <!-- (optioneel) oude web3.js mag weg; we gebruiken alleen Phantom + fetch -->
  <script>
    const ENDPOINT = "https://cbs-coin.vercel.app/api/airdrop-cbs";

    const statusEl  = document.getElementById("status");
    const airdropBtn = document.getElementById("airdropBtn");

    function ui(msg, link) {
      if (link) {
        statusEl.innerHTML = `${msg} <a href="${link}" target="_blank">Bekijk</a>`;
      } else {
        statusEl.textContent = msg;
      }
    }
    function toBase64(u8a) {
      let s = "";
      u8a.forEach(b => s += String.fromCharCode(b));
      return btoa(s);
    }

    airdropBtn.addEventListener("click", async () => {
      try {
        const phantom = window.solana || window.phantom?.solana;
        if (!phantom || !phantom.isPhantom) {
          ui("‚ùå Phantom wallet niet gevonden. Installeer de extensie en probeer opnieuw.");
          return;
        }

        // Connect (forceer prompt)
        const { publicKey } = await phantom.connect({ onlyIfTrusted: false });
        const buyer = publicKey.toString();

        if (!phantom.signMessage) {
          ui("‚ùå Je Phantom ondersteunt geen 'signMessage'. Update Phantom en probeer opnieuw.");
          return;
        }

        // Uniek bericht (timestamp tegen replay)
        const message = `CBS_AIRDROP_250:${buyer}:${Date.now()}`;
        const encoded = new TextEncoder().encode(message);
        const signed = await phantom.signMessage(encoded, "utf8");
        const signatureBase64 = toBase64(new Uint8Array(signed.signature ?? signed));

        ui("‚è≥ Claim wordt verwerkt‚Ä¶");

        const resp = await fetch(ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ buyer, message, signatureBase64 })
        });

        if (!resp.ok) {
          const txt = await resp.text();
          if (txt.includes("already_claimed")) {
            ui("‚ö†Ô∏è Deze wallet heeft al geclaimd.");
          } else {
            ui("‚ùå Fout: " + txt);
          }
          return;
        }

        const { txid } = await resp.json();
        ui("‚úÖ 250 CBS verstuurd!", `https://solscan.io/tx/${txid}`);

        // confetti üéâ
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });

      } catch (e) {
        console.error(e);
        ui("‚ùå Er ging iets mis: " + (e?.message || e));
      }
    });
  </script>

  <section class="section">
    <h3>üì¶ Token Info</h3>
    <ul>
      <li><strong>Tokennaam:</strong> CBS Coin</li>
      <li><strong>Symbool:</strong> CBS</li>
      <li><strong>Totale supply:</strong> 100.000.000</li>
      <li><strong>Mint authority:</strong> <em>uitgeschakeld</em></li>
      <li><strong>Freeze authority:</strong> <em>uitgeschakeld</em></li>
      <li><strong>Explorer:</strong> <a href="https://solscan.io/token/B9z8cEWFmc7LvQtjKsaLoKqW5MJmGRCWqs1DPKupCfkk" target="_blank">Bekijk op Solscan</a></li>
    </ul>
    <div class="button-wrapper">
      <a href="https://www.geckoterminal.com/nl/solana/pools/7RSeJd8C1cXA95Vfcz6CregUofj4dbmHgsxkF7zdWhVE" class="buy-button" target="_blank">Koop op GeckoTerminal</a>
      <a href="https://birdeye.so/token/B9z8cEWFmc7LvQtjKsaLoKqW5MJmGRCWqs1DPKupCfkk?chain=solana" class="buy-button" target="_blank">Koop op Birdeye</a>
      <a href="https://raydium.io/swap/?inputCurrency=sol&outputCurrency=B9z8cEWFmc7LvQtjKsaLoKqW5MJmGRCWqs1DPKupCfkk" class="buy-button" target="_blank">Koop op Raydium</a>
    </div>
  </section>

  <section class="section">
    <h3>üìÑ Whitepaper & Roadmap</h3>
    <p>Bekijk onze visie en plannen in de <a href="litepaper.html" target="_blank">litepaper</a>. De roadmap bevat o.a. liquidity pools, DAO integratie en tokenverificatie op grote platforms.</p>
  </section>

  <footer>
    ¬© 2025 CBS Coin ‚Äì Sovereignty through community.
    <div class="social-links">
      <a href="https://t.me/CBS_Coin" target="_blank">Telegram</a>
      <a href="https://twitter.com/CBS_Coin" target="_blank">X (Twitter)</a>
    </div>
  </footer>
</body>
</html>
