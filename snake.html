<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CBS Snake ‚Äì Play with 100 CBS</title>
  <style>
    body {
      margin:0;
      font-family:'Orbitron',sans-serif;
      background:linear-gradient(135deg,#0f0f0f,#1a1a1a);
      color:#00ffcc;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:1rem;
    }
    h1 { color:#00ffff; text-shadow:0 0 10px #00ffff; }
    canvas { background:#111; border:2px solid #00ffcc; }
    button {
      margin:10px; padding:10px 20px;
      border:none; border-radius:8px;
      background:#00ffcc; color:#000;
      font-size:16px; font-weight:bold;
      cursor:pointer; box-shadow:0 0 10px #00ffcc;
      transition:0.2s;
    }
    button:hover { background:#00ffff; }
    #leaderboard {
      margin-top:20px; padding:15px;
      background:#111; border-radius:12px;
      width:300px; box-shadow:0 0 12px #00ffcc;
    }
    #leaderboard h2 {
      margin-top:0; text-align:center; color:#00ffff;
    }
    #leaderboard ol {
      padding-left:20px;
    }
    #status { margin:10px; font-size:14px; color:#9aa; }
  </style>
</head>
<body>
  <h1>üêç CBS Snake</h1>
  <p>Entry Fee: <b>100 CBS</b> | No rewards, just glory on the <b>Wall of Fame</b>!</p>

  <button onclick="connectWallet()">Connect Phantom</button>
  <button onclick="startGame()">‚ñ∂Ô∏è Pay & Play (100 CBS)</button>
  <div id="status">Status: idle</div>

  <canvas id="gameCanvas" width="400" height="400"></canvas>

  <div id="leaderboard">
    <h2>üèÜ Wall of Fame</h2>
    <ol id="scoresList"></ol>
  </div>

<script>
  let wallet = null;
  let snake, food, dx, dy, score, gameInterval;

  // Demo wallet connect
  function connectWallet() {
    wallet = "DemoWallet_" + Math.floor(Math.random()*1000);
    document.getElementById("status").innerText = "Connected: " + wallet;
  }

  // Start game after "payment"
  function startGame() {
    if(!wallet){
      alert("Please connect Phantom first.");
      return;
    }
    document.getElementById("status").innerText = "Payment of 100 CBS simulated... Game starting!";
    snake = [{x:200, y:200}];
    dx = 20; dy = 0; score = 0;
    food = {x: Math.floor(Math.random()*20)*20, y: Math.floor(Math.random()*20)*20};
    clearInterval(gameInterval);
    gameInterval = setInterval(drawGame, 120);
  }

  function drawGame() {
    let canvas = document.getElementById("gameCanvas");
    let ctx = canvas.getContext("2d");
    ctx.fillStyle = "#000";
    ctx.fillRect(0,0,400,400);

    // draw snake
    ctx.fillStyle = "#00ffcc";
    snake.forEach(part => ctx.fillRect(part.x, part.y, 20,20));

    // move snake
    let head = {x: snake[0].x+dx, y: snake[0].y+dy};
    snake.unshift(head);

    // check food
    if(head.x===food.x && head.y===food.y){
      score++;
      food = {x: Math.floor(Math.random()*20)*20, y: Math.floor(Math.random()*20)*20};
    } else {
      snake.pop();
    }

    // draw food
    ctx.fillStyle = "#ff0066";
    ctx.fillRect(food.x, food.y, 20, 20);

    // game over
    if(head.x<0||head.y<0||head.x>=400||head.y>=400||
       snake.slice(1).some(p=>p.x===head.x && p.y===head.y)){
      clearInterval(gameInterval);
      document.getElementById("status").innerText = "Game Over! Score: "+score;
      saveScore(wallet, score);
    }
  }

  document.addEventListener("keydown", e=>{
    if(e.key==="ArrowUp" && dy===0){dx=0;dy=-20;}
    else if(e.key==="ArrowDown" && dy===0){dx=0;dy=20;}
    else if(e.key==="ArrowLeft" && dx===0){dx=-20;dy=0;}
    else if(e.key==="ArrowRight" && dx===0){dx=20;dy=0;}
  });

  // Leaderboard demo
  let scores = [];
  function saveScore(wallet, score){
    scores.push({wallet, score});
    scores.sort((a,b)=>b.score-a.score);
    scores = scores.slice(0,10);
    let list = document.getElementById("scoresList");
    list.innerHTML = "";
    scores.forEach(s=>{
      let li = document.createElement("li");
      li.textContent = s.wallet+" ‚Äî "+s.score;
      list.appendChild(li);
    });
  }
</script>
</body>
</html>
